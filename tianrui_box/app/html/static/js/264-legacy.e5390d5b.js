"use strict";(self.webpackChunkweb_client_video_gateway=self.webpackChunkweb_client_video_gateway||[]).push([[264],{72264:function(e,l,t){t.r(l),t.d(l,{default:function(){return i}}),t(9653);var a=t(94351),i=(l={data:function(){return{listLoading:!1,mapDialog:!1,callBackForm:{device_uuid:void 0,driver:void 0,car_code:void 0,limited_speed:void 0,cron_time:0,tire_time:0,lng:void 0,lat:void 0},diglog:"add",tireOptions:[{key:1,label:"一小时"},{key:2,label:"两小时"},{key:3,label:"三小时"},{key:4,label:"四小时"},{key:5,label:"五小时"},{key:6,label:"六小时"},{key:8,label:"八小时"}],ruleForm:{device_uuid:{required:!0,message:"请输入设备ID",trigger:"blur"},driver:{required:!0,message:"请输入司机名称",trigger:"blur"},car_code:{required:!0,message:"请输入车牌号",trigger:"blur"},limited_speed:{required:!0,message:"请输入限速（km/h）",trigger:"blur"},lat:{required:!0,message:"请输入经度",trigger:"blur"},lng:{required:!0,message:"请输入纬度",trigger:"blur"}},filtersForm:{page:0,page_size:10},total:10,loading:!1,tableData:[],logColumns:[{width:"",prop:"device_uuid",flag:!0,label:"设备ID"},{width:"",prop:"driver",flag:!0,label:"司机"},{width:"",prop:"car_code",flag:!0,label:"车牌号"},{width:"",prop:"limited_speed",flag:!0,label:"限速（km/h）"},{width:"",flag:!0,prop:"lng",label:"经度"},{width:"",prop:"lat",flag:!0,label:"纬度"},{width:"",prop:"cron_time",flag:!0,label:"定时上报时间（秒）"},{width:"",prop:"tire_time",flag:!0,label:"疲劳驾驶时间"},{width:"",prop:"create_time",flag:!0,label:"创建时间"}]}},mounted:function(){this.getList()},methods:{getList:function(){var e=this;this.tableData=[],this.listLoading=!0,(0,a.getDevices)(this.filtersForm).then((function(l){200===l.code&&(e.tableData=l.data,e.total=l.total_count),e.listLoading=!1})).catch((function(l){e.listLoading=!1}))},addVehicle:function(){this.diglog="add",this.mapDialog=!0},handleClose:function(){this.mapDialog=!1,this.callBackForm={driver:void 0,car_code:void 0,limited_speed:void 0,lng:void 0,lat:void 0},this.$refs.callBackForm&&this.$refs.callBackForm.resetFields()},handleAdd:function(){var e=this,l=this;this.$refs.callBackForm.validate((function(t){t&&(l.callBackForm.limited_speed=Number(l.callBackForm.limited_speed),l.callBackForm.tire_time=60*l.callBackForm.tire_time*60,l.callBackForm.cron_time&&(l.callBackForm.cron_time=parseInt(l.callBackForm.cron_time)),(0,a.getDevicesAdd)(l.callBackForm).then((function(l){200===l.code&&("add"===e.diglog?e.$message({message:"恭喜你，新增成功！",type:"success"}):e.$message({message:"恭喜你，编辑成功！",type:"success"})),e.getList(),e.mapDialog=!1})).catch((function(e){})))}))},handleEdit:function(e){var l=this;this.mapDialog=!0,this.diglog="edit",(0,a.getDevices)({did:e.did}).then((function(e){200===e.code&&(l.callBackForm=e.data[0],l.callBackForm.tire_time=l.callBackForm.tire_time/3600),l.listLoading=!1})).catch((function(e){l.listLoading=!1}))},handleDelete:function(e){var l=this;l.$confirm("此操作将删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(0,a.getDevicesDelete)({did:e.did}).then((function(e){l.$message({type:"success",message:"删除成功!"}),l.getList()}))})).catch((function(){}))},handleSizeChange:function(e){this.filtersForm.page=0,this.filtersForm.page_size=e,this.getList()},handleCurrentChange:function(e){this.filtersForm.page=e-1,this.getList()}}},(0,t(43736).Z)(l,(function(){var e=this,l=e.$createElement,t=e._self._c||l;return t("div",{staticClass:"alarm-page"},[t("div",{staticClass:"eg-add"},[t("el-button",{attrs:{type:"primary"},on:{click:e.addVehicle}},[e._v("新增")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"table-item",attrs:{data:e.tableData,height:"string",width:"100% ","element-loading-text":"数据加载中","header-cell-style":{"text-align":"center",color:"#606266",background:"#fafafa"},"cell-style":{"text-align":"center"},"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.2)"}},[t("el-table-column",{attrs:{label:"序号",align:"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(l){return[e._v(e._s(e.filtersForm.page*e.filtersForm.page_size+l.$index+1))]}}])}),e._l(e.logColumns,(function(l){return[l.flag?t("el-table-column",{key:l.prop,attrs:{prop:l.prop,label:l.label,width:l.width,align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return["etype"===l.prop?t("span",[e._v(e._s(e._f("deviceTypeFilter")(a.row[l.prop])))]):e._e(),"tire_time"===l.prop?t("span",[e._v(e._s(e._f("timeTypeFilter")(a.row[l.prop])))]):t("span",[e._v(e._s(a.row[l.prop]))])]}}],null,!0)}):e._e()]})),t("el-table-column",{attrs:{label:"操作",align:"center",width:"140"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("span",{staticClass:"g-text-btn",on:{click:function(t){return e.handleEdit(l.row)}}},[e._v("编辑")]),t("span",{staticClass:"g-del-btn g-text-btn",on:{click:function(t){return e.handleDelete(l.row)}}},[e._v("删除")])]}}])})],2),t("div",{staticClass:"page-footer"},[t("el-pagination",{attrs:{background:!0,"current-page":e.filtersForm.page+1,"page-sizes":[10,20,30,100],"page-size":e.filtersForm.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{visible:e.mapDialog,width:"29.2%"},on:{"update:visible":function(l){e.mapDialog=l},closed:e.handleClose}},[t("template",{slot:"title"},[t("div",{staticClass:"el-dialog-title"},[e._v("车辆"+e._s("edit"===e.diglog?"编辑":"添加"))])]),t("el-form",{ref:"callBackForm",staticClass:"callBackForm",attrs:{rules:e.ruleForm,model:e.callBackForm,"label-width":"130px"}},[t("el-form-item",{attrs:{label:"设备ID：",prop:"device_uuid"}},[t("el-input",{attrs:{clearable:"",maxlength:"500","show-word-limit":"",disabled:"edit"===e.diglog,placeholder:"请输入设备ID"},model:{value:e.callBackForm.device_uuid,callback:function(l){e.$set(e.callBackForm,"device_uuid",l)},expression:"callBackForm.device_uuid"}})],1),t("el-form-item",{attrs:{label:"司机：",prop:"driver"}},[t("el-input",{attrs:{clearable:"",maxlength:"500","show-word-limit":"",placeholder:"请输入司机名称"},model:{value:e.callBackForm.driver,callback:function(l){e.$set(e.callBackForm,"driver",l)},expression:"callBackForm.driver"}})],1),t("el-form-item",{attrs:{label:"车牌号：",prop:"car_code"}},[t("el-input",{attrs:{clearable:"",maxlength:"500","show-word-limit":"",placeholder:"请输入车牌号"},model:{value:e.callBackForm.car_code,callback:function(l){e.$set(e.callBackForm,"car_code",l)},expression:"callBackForm.car_code"}})],1),t("el-form-item",{attrs:{label:"限速（km/h）：",prop:"limited_speed"}},[t("el-input",{attrs:{clearable:"",maxlength:"500","show-word-limit":"",placeholder:"请输入限速（km/h）"},model:{value:e.callBackForm.limited_speed,callback:function(l){e.$set(e.callBackForm,"limited_speed",l)},expression:"callBackForm.limited_speed"}})],1),t("el-form-item",{attrs:{label:"经度：",prop:"lng"}},[t("el-input",{attrs:{clearable:"",maxlength:"500","show-word-limit":"",placeholder:"请输入经度"},model:{value:e.callBackForm.lng,callback:function(l){e.$set(e.callBackForm,"lng",l)},expression:"callBackForm.lng "}})],1),t("el-form-item",{attrs:{label:"纬度：",prop:"lat"}},[t("el-input",{attrs:{clearable:"",maxlength:"500","show-word-limit":"",placeholder:"请输入纬度"},model:{value:e.callBackForm.lat,callback:function(l){e.$set(e.callBackForm,"lat",l)},expression:"callBackForm.lat"}})],1),t("el-form-item",{attrs:{label:"定时上报时间："}},[t("el-input",{attrs:{clearable:"",type:"number",min:0,oninput:"value=parseInt(value.replace(/[^\\d]/g,''))",maxlength:"6","show-word-limit":"",placeholder:"请输入定时上报时间（秒）"},model:{value:e.callBackForm.cron_time,callback:function(l){e.$set(e.callBackForm,"cron_time",l)},expression:"callBackForm.cron_time"}})],1),t("el-form-item",{attrs:{label:"疲劳驾驶时间："}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择疲劳驾驶时间"},model:{value:e.callBackForm.tire_time,callback:function(l){e.$set(e.callBackForm,"tire_time",l)},expression:"callBackForm.tire_time"}},e._l(e.tireOptions,(function(e){return t("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(l){e.mapDialog=!1}}},[e._v("关闭")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("确定")])],1)],2)],1)}),[],!1,null,"6a7be11e",null).exports)}}]);